# perftest

The perftest is collection conatains a set of bandwidth and latency benchmark such as:
- Read   - `ib_read_bw` and `ib_read_lat`.
- Write  - `ib_write_bw` and `ib_wriet_lat`.
- Send   - `ib_send_bw` and `ib_send_lat`.
- Atomic - `ib_atomic_bw` and `ib_atomic_lat`
- Raw Etherent (when working with MOFED2) - `raw_ethernet_bw`, `raw_ethernet_lat`

## Read test 

### read bandwidth

Server:
```
[root@server ~]# ib_read_bw --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0131 PSN 0x30b4f1 OUT 0x10 RKey 0x00b1cb VAddr 0x00ffffb6610000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x011b PSN 0x3ec2a6 OUT 0x10 RKey 0x01a57e VAddr 0x00ffffa7260000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 8388608    1000             1505.89            1505.85            0.000188
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_read_bw --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    RDMA_Read BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x011b PSN 0x3ec2a6 OUT 0x10 RKey 0x01a57e VAddr 0x00ffffa7260000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0131 PSN 0x30b4f1 OUT 0x10 RKey 0x00b1cb VAddr 0x00ffffb6610000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 2          1000             2.89               2.84               1.486939
 4          1000             5.78               5.60               1.467906
 8          1000             11.56              11.33              1.485456
 16         1000             23.12              22.64              1.483419
 32         1000             46.24              44.82              1.468645
 64         1000             92.48              90.44              1.481786
 128        1000             179.52             177.02             1.450133
 256        1000             369.91             359.16             1.471110
 512        1000             739.82             723.04             1.480776
 1024       1000             1436.12            1394.37            1.427837
 2048       1000             1479.64            1477.94            0.756705
 4096       1000             1502.42            1498.89            0.383715
 8192       1000             1508.22            1503.72            0.192476
 16384      1000             1505.30            1504.52            0.096289
 32768      1000             1506.75            1505.37            0.048172
 65536      1000             1506.02            1505.75            0.024092
 131072     1000             1506.02            1505.79            0.012046
 262144     1000             1506.02            1505.92            0.006024
 524288     1000             1505.95            1505.67            0.003011
 1048576    1000             1505.90            1505.89            0.001506
 2097152    1000             1505.96            1505.87            0.000753
 4194304    1000             1505.99            1505.91            0.000376
 8388608    1000             1505.89            1505.85            0.000188
---------------------------------------------------------------------------------------
```

### read latency

Server:
```
[root@server ~]# ib_read_lat --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    RDMA_Read Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0132 PSN 0x1a0fd4 OUT 0x10 RKey 0x00c9f5 VAddr 0x00ffff90ab0000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x011c PSN 0x1381ea OUT 0x10 RKey 0x01a881 VAddr 0x00ffff846c0000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_read_lat --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    RDMA_Read Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 1
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x011c PSN 0x1381ea OUT 0x10 RKey 0x01a881 VAddr 0x00ffff846c0000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0132 PSN 0x1a0fd4 OUT 0x10 RKey 0x00c9f5 VAddr 0x00ffff90ab0000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 2       1000          4.10           4.54         4.14                4.16             0.04            4.32                    4.54
 4       1000          4.10           6.72         4.14                4.15             0.04            4.32                    6.72
 8       1000          4.10           4.56         4.14                4.16             0.04            4.34                    4.56
 16      1000          4.10           4.50         4.16                4.16             0.03            4.26                    4.50
 32      1000          4.10           5.10         4.16                4.17             0.06            4.50                    5.10
 64      1000          4.12           5.86         4.18                4.19             0.05            4.40                    5.86
 128     1000          4.24           4.70         4.30                4.33             0.07            4.60                    4.70
 256     1000          4.38           5.34         4.44                4.45             0.06            4.78                    5.34
 512     1000          4.66           6.06         4.72                4.72             0.05            5.04                    6.06
 1024    1000          5.24           5.66         5.28                5.29             0.05            5.58                    5.66
 2048    1000          5.90           7.16         5.98                5.99             0.06            6.22                    7.16
 4096    1000          7.20           7.62         7.28                7.28             0.05            7.58                    7.62
 8192    1000          9.80           10.30        9.88                9.89             0.06            10.20                   10.30
 16384   1000          14.98          18.78        15.06               15.08            0.07            15.38                   18.78
 32768   1000          25.34          25.84        25.44               25.45            0.06            25.70                   25.84
 65536   1000          46.08          46.58        46.18               46.20            0.07            46.42                   46.58
 131072  1000          87.56          89.20        87.64               87.71            0.13            88.18                   89.20
 262144  1000          170.50         171.42       170.60              170.70           0.19            171.26                  171.42
 524288  1000          336.38         339.20       336.58              336.78           0.40            337.92                  339.20
 1048576 1000          668.36         671.26       668.76              668.95           0.57            670.42                  671.26
 2097152 1000          1331.90        1334.96      1332.76             1332.99          0.71            1334.48                 1334.96
 4194304 1000          2659.36        2693.08      2661.02             2661.08          1.41            2663.48                 2693.08
 8388608 1000          5314.45        5369.47      5316.89             5317.10          2.62            5320.33                 5369.47
---------------------------------------------------------------------------------------
```

## Write test

### write bandwidth

Server:
```
[root@server ~]# ib_write_bw --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    RDMA_Write BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 0[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0133 PSN 0x77ceaa RKey 0x00de1b VAddr 0x00ffffa6e30000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x011d PSN 0x37586e RKey 0x01aba2 VAddr 0x00ffff85e10000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 8388608    5000             2729.63            2729.60            0.000341
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_write_bw --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    RDMA_Write BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 0[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x011d PSN 0x37586e RKey 0x01aba2 VAddr 0x00ffff85e10000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0133 PSN 0x77ceaa RKey 0x00de1b VAddr 0x00ffffa6e30000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 2          5000             3.18               3.15               1.653372
 4          5000             6.36               6.28               1.645966
 8          5000             12.72              12.56              1.646294
 16         5000             25.43              25.18              1.650405
 32         5000             50.86              50.32              1.648980
 64         5000             101.73             100.96             1.654146
 128        5000             203.45             198.77             1.628343
 256        5000             406.91             399.23             1.635243
 512        5000             813.81             795.61             1.629410
 1024       5000             1627.62            1570.40            1.608085
 2048       5000             2712.67            2704.04            1.384470
 4096       5000             2750.91            2717.17            0.695596
 8192       5000             2731.67            2723.56            0.348615
 16384      5000             2731.66            2726.71            0.174509
 32768      5000             2731.67            2728.22            0.087303
 65536      5000             2729.25            2728.93            0.043663
 131072     5000             2730.46            2728.89            0.021831
 262144     5000             2729.86            2729.51            0.010918
 524288     5000             2729.85            2729.44            0.005459
 1048576    5000             2729.73            2729.56            0.002730
 2097152    5000             2729.69            2729.60            0.001365
 4194304    5000             2729.62            2729.59            0.000682
 8388608    5000             2729.63            2729.60            0.000341
---------------------------------------------------------------------------------------
```

### write latency

Server:
```
[root@server ~]# ib_write_lat --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    RDMA_Write Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 220[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0134 PSN 0x8be7c7 RKey 0x00e01d VAddr 0x00ffff8f070000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x011e PSN 0x1bd392 RKey 0x01cec4 VAddr 0x00ffffa2ee0000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 2       1000          2.57           23.96        2.60                2.60             0.02            2.66                    23.96
 4       1000          2.57           5.01         2.60                2.60             0.02            2.67                    5.01
 8       1000          2.58           2.86         2.60                2.61             0.03            2.76                    2.86
 16      1000          2.58           7.17         2.62                2.63             0.13            2.78                    7.17
 32      1000          2.63           5.70         2.67                2.68             0.04            2.85                    5.70
 64      1000          2.72           4.84         2.75                2.75             0.03            2.90                    4.84
 128     1000          2.83           10.34        2.86                3.08             0.37            3.82                    10.34
 256     1000          3.77           6.31         3.89                3.89             0.06            3.93                    6.31
 512     1000          3.99           7.68         4.02                4.03             0.07            4.29                    7.68
 1024    1000          4.36           8.16         4.40                4.42             0.06            4.57                    8.16
 2048    1000          4.98           8.25         5.02                5.05             0.10            5.20                    8.25
 4096    1000          6.07           9.66         6.12                6.16             0.10            6.35                    9.66
 8192    1000          8.08           10.12        8.24                8.21             0.10            8.42                    10.12
 16384   1000          12.12          12.50        12.28               12.27            0.06            12.43                   12.50
 32768   1000          20.22          22.36        20.40               20.40            0.09            20.60                   22.36
 65536   1000          36.30          36.72        36.49               36.49            0.06            36.66                   36.72
 131072  1000          68.43          71.36        68.61               68.64            0.12            68.93                   71.36
 262144  1000          132.82         134.97       132.99              133.02           0.11            133.35                  134.97
 524288  1000          261.54         292.94       261.75              261.82           0.19            262.29                  292.94
 1048576 1000          519.01         521.83       519.37              519.44           0.27            520.20                  521.83
 2097152 1000          1033.99        1053.46      1034.46             1034.56          0.43            1035.29                 1053.46
 4194304 1000          2064.23        2097.45      2064.98             2065.01          0.79            2066.36                 2097.45
 8388608 1000          4124.43        4152.18      4125.65             4125.74          1.41            4127.51                 4152.18
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_write_lat --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    RDMA_Write Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 1
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 220[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x011e PSN 0x1bd392 RKey 0x01cec4 VAddr 0x00ffffa2ee0000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0134 PSN 0x8be7c7 RKey 0x00e01d VAddr 0x00ffff8f070000
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 2       1000          2.57           3.98         2.60                2.60             0.02            2.65                    3.98
 4       1000          2.57           3.38         2.60                2.60             0.02            2.67                    3.38
 8       1000          2.57           2.88         2.60                2.61             0.03            2.77                    2.88
 16      1000          2.59           6.55         2.62                2.62             0.04            2.78                    6.55
 32      1000          2.64           5.65         2.67                2.68             0.03            2.79                    5.65
 64      1000          2.72           3.43         2.75                2.75             0.03            2.90                    3.43
 128     1000          2.83           3.90         3.25                3.08             0.21            3.42                    3.90
 256     1000          3.77           5.69         3.89                3.89             0.03            3.94                    5.69
 512     1000          3.98           5.39         4.02                4.03             0.05            4.28                    5.39
 1024    1000          4.36           5.40         4.40                4.42             0.05            4.56                    5.40
 2048    1000          4.97           7.64         5.02                5.05             0.08            5.32                    7.64
 4096    1000          6.07           8.34         6.12                6.16             0.08            6.37                    8.34
 8192    1000          8.08           9.84         8.24                8.21             0.09            8.42                    9.84
 16384   1000          12.12          12.60        12.28               12.27            0.06            12.43                   12.60
 32768   1000          20.22          22.53        20.40               20.40            0.07            20.60                   22.53
 65536   1000          36.31          36.73        36.49               36.49            0.07            36.66                   36.73
 131072  1000          68.43          70.64        68.61               68.63            0.12            68.89                   70.64
 262144  1000          132.79         134.17       132.99              133.02           0.11            133.36                  134.17
 524288  1000          261.54         292.48       261.75              261.82           0.18            262.29                  292.48
 1048576 1000          519.02         520.66       519.38              519.44           0.27            520.22                  520.66
 2097152 1000          1033.97        1044.38      1034.45             1034.55          0.32            1035.25                 1044.38
 4194304 1000          2064.15        2093.34      2064.90             2064.94          0.78            2066.36                 2093.34
 8388608 1000          4124.25        4151.66      4125.46             4125.54          1.38            4127.29                 4151.66
---------------------------------------------------------------------------------------
```

## Send test

### send bandwidth

Server:
```
[root@server ~]# ib_send_bw --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    Send BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 RX depth        : 512
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 0[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0135 PSN 0xa57f35
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x011f PSN 0x2a05d7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 2          1000             0.00               3.26               1.706914
 4          1000             0.00               6.40               1.676505
 8          1000             0.00               12.85              1.684474
 16         1000             0.00               25.84              1.693600
 32         1000             0.00               52.19              1.710111
 64         1000             0.00               104.58             1.713391
 128        1000             0.00               208.23             1.705796
 256        1000             0.00               437.69             1.792761
 512        1000             0.00               824.02             1.687600
 1024       1000             0.00               1629.40            1.668505
 2048       1000             0.00               2728.46            1.396973
 4096       1000             0.00               2732.49            0.699518
 8192       1000             0.00               2732.45            0.349754
 16384      1000             0.00               2732.44            0.174876
 32768      1000             0.00               2732.43            0.087438
 65536      1000             0.00               2732.46            0.043719
 131072     1000             0.00               2732.46            0.021860
 262144     1000             0.00               2731.42            0.010926
 524288     1000             0.00               2732.12            0.005464
 1048576    1000             0.00               2732.41            0.002732
 2097152    1000             0.00               2732.43            0.001366
 4194304    1000             0.00               2732.22            0.000683
 8388608    1000             0.00               2732.27            0.000342
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_send_bw --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    Send BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 0[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x011f PSN 0x2a05d7
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0135 PSN 0xa57f35
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 2          1000             3.29               3.20               1.678005
 4          1000             6.58               6.32               1.655580
 8          1000             13.15              12.71              1.665343
 16         1000             26.31              25.57              1.676066
 32         1000             52.62              51.62              1.691433
 64         1000             105.23             103.28             1.692184
 128        1000             210.47             205.77             1.685664
 256        1000             420.94             409.55             1.677533
 512        1000             841.87             814.19             1.667459
 1024       1000             1627.61            1607.41            1.645986
 2048       1000             2712.69            2689.08            1.376809
 4096       1000             2712.71            2711.80            0.694222
 8192       1000             2731.67            2720.60            0.348237
 16384      1000             2731.64            2725.27            0.174417
 32768      1000             2731.65            2727.55            0.087281
 65536      1000             2729.27            2728.60            0.043658
 131072     1000             2729.25            2729.16            0.021833
 262144     1000             2729.26            2728.44            0.010914
 524288     1000             2729.58            2729.31            0.005459
 1048576    1000             2729.73            2729.64            0.002730
 2097152    1000             2729.70            2729.65            0.001365
 4194304    1000             2729.65            2729.63            0.000682
 8388608    1000             2729.62            2729.58            0.000341
---------------------------------------------------------------------------------------
```

### send latency

Server:
```
[root@server ~]# ib_send_lat --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    Send Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 RX depth        : 512
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 236[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0136 PSN 0x42caee
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x0120 PSN 0x939bd2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 2       1000          2.78           5.14         2.95                2.91             0.09            3.12                    5.14
 4       1000          2.79           4.09         2.95                2.90             0.08            3.13                    4.09
 8       1000          2.80           4.06         2.90                2.91             0.08            3.08                    4.06
 16      1000          2.78           9.92         2.94                2.91             0.10            3.14                    9.92
 32      1000          2.79           4.21         2.95                2.90             0.08            3.12                    4.21
 64      1000          2.90           4.51         2.95                3.01             0.09            3.20                    4.51
 128     1000          2.98           4.49         3.40                3.30             0.23            3.69                    4.49
 256     1000          3.88           5.76         3.95                4.00             0.08            4.20                    5.76
 512     1000          4.12           8.13         4.23                4.23             0.13            4.43                    8.13
 1024    1000          4.60           6.23         4.76                4.73             0.10            4.98                    6.23
 2048    1000          5.20           7.41         5.36                5.33             0.09            5.55                    7.41
 4096    1000          6.29           6.79         6.42                6.41             0.08            6.57                    6.79
 8192    1000          8.30           8.68         8.40                8.42             0.08            8.62                    8.68
 16384   1000          12.32          14.42        12.48               12.46            0.11            12.68                   14.42
 32768   1000          20.36          22.66        20.54               20.51            0.09            20.72                   22.66
 65536   1000          36.45          38.68        36.62               36.60            0.11            36.86                   38.68
 131072  1000          68.62          71.25        68.79               68.80            0.13            69.20                   71.25
 262144  1000          133.01         134.29       133.21              133.23           0.16            133.66                  134.29
 524288  1000          261.73         264.65       261.96              262.02           0.21            262.58                  264.65
 1048576 1000          519.19         523.19       519.49              519.55           0.25            520.27                  523.19
 2097152 1000          1034.15        1047.13      1034.71             1034.78          0.48            1035.66                 1047.13
 4194304 1000          2064.32        2095.48      2065.05             2065.11          0.76            2066.28                 2095.48
 8388608 1000          4124.47        4159.45      4125.67             4125.85          2.00            4128.90                 4159.45
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_send_lat --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    Send Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 1
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Max inline data : 236[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0120 PSN 0x939bd2
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0136 PSN 0x42caee
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 2       1000          2.79           7.81         2.94                2.91             0.09            3.12                    7.81
 4       1000          2.79           5.89         2.95                2.91             0.09            3.14                    5.89
 8       1000          2.80           5.62         2.90                2.91             0.08            3.08                    5.62
 16      1000          2.79           9.97         2.94                2.91             0.19            3.17                    9.97
 32      1000          2.80           5.78         2.95                2.90             0.08            3.13                    5.78
 64      1000          2.89           6.82         2.95                3.01             0.09            3.22                    6.82
 128     1000          2.98           6.09         3.15                3.30             0.38            4.03                    6.09
 256     1000          3.89           5.82         3.95                4.00             0.08            4.19                    5.82
 512     1000          4.12           8.63         4.24                4.24             0.18            4.43                    8.63
 1024    1000          4.61           7.49         4.76                4.73             0.10            4.98                    7.49
 2048    1000          5.20           8.81         5.36                5.33             0.09            5.55                    8.81
 4096    1000          6.29           6.69         6.43                6.41             0.08            6.60                    6.69
 8192    1000          8.31           8.67         8.41                8.42             0.08            8.62                    8.67
 16384   1000          12.32          14.77        12.48               12.46            0.11            12.69                   14.77
 32768   1000          20.37          25.26        20.54               20.51            0.10            20.73                   25.26
 65536   1000          36.46          41.49        36.62               36.60            0.11            36.85                   41.49
 131072  1000          68.62          76.27        68.79               68.80            0.13            69.23                   76.27
 262144  1000          133.01         133.99       133.21              133.23           0.16            133.71                  133.99
 524288  1000          261.76         267.46       261.97              262.03           0.21            262.59                  267.46
 1048576 1000          519.21         526.06       519.49              519.54           0.25            520.29                  526.06
 2097152 1000          1034.10        1046.58      1034.67             1034.75          0.52            1035.64                 1046.58
 4194304 1000          2064.20        2095.18      2064.93             2065.00          0.81            2066.24                 2095.18
 8388608 1000          4124.26        4159.09      4125.47             4125.63          1.99            4128.75                 4159.09
---------------------------------------------------------------------------------------
```

## Atomic test

### Atomic bandwidth

Server:
```
[root@server ~]# ib_atomic_bw --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    Atomic FETCH_AND_ADD BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0137 PSN 0xf346a9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x0121 PSN 0x5ca06
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 8          1000             8.29               8.18               1.071891
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_atomic_bw --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    Atomic FETCH_AND_ADD BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0121 PSN 0x5ca06
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0137 PSN 0xf346a9
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 8          1000             8.29               8.18               1.071891
---------------------------------------------------------------------------------------
```

### Atomic latency

Server:
```
[root@server ~]# ib_atomic_lat --all --CPU-freq --ib-dev mlx5_0

************************************
* Waiting for client to connect... *
************************************
---------------------------------------------------------------------------------------
                    Atomic FETCH_AND_ADD Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0138 PSN 0xf6993a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
 remote address: LID 0000 QPN 0x0122 PSN 0xaf29e0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# ib_atomic_lat --all --CPU-freq --ib-dev mlx5_0 192.168.1.5
---------------------------------------------------------------------------------------
                    Atomic FETCH_AND_ADD Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RC           Using SRQ      : OFF
 TX depth        : 1
 Mtu             : 1024[B]
 Link type       : Ethernet
 GID index       : 2
 Outstand reads  : 16
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
 local address: LID 0000 QPN 0x0122 PSN 0xaf29e0
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:06
 remote address: LID 0000 QPN 0x0138 PSN 0xf6993a
 GID: 00:00:00:00:00:00:00:00:00:00:255:255:192:168:01:05
---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 8       1000          4.08           10.00        4.14                4.16             0.06            4.42                    10.00
---------------------------------------------------------------------------------------
```

## Raw Etherent

### Raw Etherent bandwidth

Server:
```
[root@server ~]# raw_ethernet_bw --server -d mlx5_0 --dest_mac 0c:42:a1:7f:e7:dc --source_mac 0c:42:a1:7f:ee:04 --dest_ip 192.168.1.5
 Max msg size in RawEth is MTU 1518
 Changing msg size to this MTU
---------------------------------------------------------------------------------------
                    Send BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RawEth               Using SRQ      : OFF
 RX depth        : 512
 CQ Moderation   : 100
 Mtu             : 1518[B]
 Link type       : Ethernet
 GID index       : 0
 Max inline data : 0[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
MAC attached  : 0C:42:A1:7F:EE:04
---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 1518       1000             0.00               3261.39            2.252840
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# raw_ethernet_bw --client -d mlx5_0 --dest_mac 0c:42:a1:7f:ee:04  --source_mac 0c:42:a1:7f:e7:dc --dest_ip 192.168.1.5
 Max msg size in RawEth is MTU 1518
 Changing msg size to this MTU
---------------------------------------------------------------------------------------
                    Send BW Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RawEth               Using SRQ      : OFF
 TX depth        : 128
 CQ Moderation   : 100
 Mtu             : 1518[B]
 Link type       : Ethernet
 GID index       : 0
 Max inline data : 0[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
**raw ethernet header****************************************

--------------------------------------------------------------
| Dest MAC         | Src MAC          | Packet Type          |
|------------------------------------------------------------|
| 0C:42:A1:7F:EE:04| 0C:42:A1:7F:E7:DC|IPv4                  |
|------------------------------------------------------------|

**IP header**************
|-----------------------|
|Version   |4           |
|Ihl       |5           |
|TOS       |0           |
|TOT LEN   |1500        |
|ID        |0           |
|Frag      |0           |
|TTL       |128         |
|protocol  |EMPTY       |
|Check sum |7375        |
|Source IP |0.0.0.0     |
|Dest IP   |192.168.1.5 |
|-----------------------|

---------------------------------------------------------------------------------------
 #bytes     #iterations    BW peak[MB/sec]    BW average[MB/sec]   MsgRate[Mpps]
 1518       1000             2895.27            2759.09            1.905870
---------------------------------------------------------------------------------------
```

### Raw Etherent latency

Server:
```
[root@server ~]# raw_ethernet_lat --server -d mlx5_0 --dest_mac 0c:42:a1:7f:e7:dc --source_mac 0c:42:a1:7f:ee:04 --CPU-freq --mtu 1500 --report_gbits --dest_ip 192.168.1.5
 Min msg size for RawEth is 64B - changing msg size to 64
---------------------------------------------------------------------------------------
                    Send Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RawEth               Using SRQ      : OFF
 TX depth        : 1
 RX depth        : 512
 Mtu             : 1500[B]
 Link type       : Ethernet
 GID index       : 0
 Max inline data : 236[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
MAC attached  : 0C:42:A1:7F:EE:04
**raw ethernet header****************************************

--------------------------------------------------------------
| Dest MAC         | Src MAC          | Packet Type          |
|------------------------------------------------------------|
| 0C:42:A1:7F:E7:DC| 0C:42:A1:7F:EE:04|IPv4                  |
|------------------------------------------------------------|

**IP header**************
|-----------------------|
|Version   |4           |
|Ihl       |5           |
|TOS       |0           |
|TOT LEN   |46          |
|ID        |0           |
|Frag      |0           |
|TTL       |128         |
|protocol  |EMPTY       |
|Check sum |3AD1        |
|Source IP |0.0.0.0     |
|Dest IP   |0.0.0.0     |
|-----------------------|

---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 64      1000          2.85           8.42         2.99                2.96             0.10            3.17                    8.42
---------------------------------------------------------------------------------------
```

Client:
```
[root@client ~]# raw_ethernet_lat --client -d mlx5_0 --dest_mac  0c:42:a1:7f:ee:04 --source_mac 0c:42:a1:7f:e7:dc --CPU-freq --mtu 1500 --report_gbits --dest_ip 192.168.1.5
 Min msg size for RawEth is 64B - changing msg size to 64
---------------------------------------------------------------------------------------
                    Send Latency Test
 Dual-port       : OFF          Device         : mlx5_0
 Number of qps   : 1            Transport type : IB
 Connection type : RawEth               Using SRQ      : OFF
 TX depth        : 1
 RX depth        : 512
 Mtu             : 1500[B]
 Link type       : Ethernet
 GID index       : 0
 Max inline data : 236[B]
 rdma_cm QPs     : OFF
 Data ex. method : Ethernet
---------------------------------------------------------------------------------------
MAC attached  : 0C:42:A1:7F:E7:DC
**raw ethernet header****************************************

--------------------------------------------------------------
| Dest MAC         | Src MAC          | Packet Type          |
|------------------------------------------------------------|
| 0C:42:A1:7F:EE:04| 0C:42:A1:7F:E7:DC|IPv4                  |
|------------------------------------------------------------|

**IP header**************
|-----------------------|
|Version   |4           |
|Ihl       |5           |
|TOS       |0           |
|TOT LEN   |46          |
|ID        |0           |
|Frag      |0           |
|TTL       |128         |
|protocol  |EMPTY       |
|Check sum |7923        |
|Source IP |0.0.0.0     |
|Dest IP   |192.168.1.5 |
|-----------------------|

---------------------------------------------------------------------------------------
 #bytes #iterations    t_min[usec]    t_max[usec]  t_typical[usec]    t_avg[usec]    t_stdev[usec]   99% percentile[usec]   99.9% percentile[usec]
 64      1000          2.85           8.46         2.99                2.96             0.10            3.20                    8.46
---------------------------------------------------------------------------------------
```